#!/bin/sh

set -e

echo JUnit testing project in $WORKSPACE with maven home as $MVN_LOCAL_REPO

cd $WORKSPACE

echo Setting MySQL environment variables for the app [$MYSQL_USER:$MYSQL_PASSWORD@$MYSQL_HOST/$MYSQL_DATABASE]

# mvn -Dmaven.repo.local=$MVN_LOCAL_REPO test

echo -Dmaven.repo.local=$MVN_LOCAL_REPO -DMYSQL_HOST=${MYSQL_HOST} -DMYSQL_USER=${MYSQL_USER} -DMYSQL_PASSWORD=${MYSQL_PASSWORD} -DMYSQL_DATABASE=${MYSQL_DATABASE} -DMONGO_URL=${MONGO_URL} -DMONGO_HOST=${MONGO_HOST} -DMONGO_PORT=${MONGO_PORT} -DMONGO_USER=${MONGO_USER} -DMONGO_PASSWORD=${MONGO_PASSWORD} test
mvn -Dmaven.repo.local=$MVN_LOCAL_REPO -DMYSQL_HOST=${MYSQL_HOST} -DMYSQL_USER=${MYSQL_USER} -DMYSQL_PASSWORD=${MYSQL_PASSWORD} -DMYSQL_DATABASE=${MYSQL_DATABASE} -DMONGO_URL=${MONGO_URL} -DMONGO_HOST=${MONGO_HOST} -DMONGO_PORT=${MONGO_PORT} -DMONGO_USER=${MONGO_USER} -DMONGO_PASSWORD=${MONGO_PASSWORD} test